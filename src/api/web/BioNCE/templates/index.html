{% extends "layout.html" %}

{% block content %}
	<section>
		<h2>Draw or send a file:</h2>
		<script type="text/javascript" language="javascript" src="/static/js/lib/jsme/jsme.nocache.js"></script>
		<style>
			em {background-color:rgb(102,255,255);}
		</style>

		<script>
			//this function will be called after the JavaScriptApplet code has been loaded.
			function jsmeOnLoad() {
				jsmeApplet = new JSApplet.JSME("jsme_container", "380px", "340px", {
					"options" : "star"
				});
				jsmeApplet.setNotifyStructuralChangeJSfunction( "show_smiles" );
			}

			//var patt=/\[([A-Za-z][a-z]?)H?\d*:\d+\]/g; //regexp pattern for numbered atom
			function show_smiles() {
				//smiles = jsmeApplet.smiles(); //atom that are colored are numbered
				//new_smiles = smiles.replace(patt, '<em>$1</em>');
				document.getElementById("smiles_container").innerHTML = jsmeApplet.smiles();
			}

			function transfer_smiles() {
				if ( document.getElementById("smilesLines").innerHTML != "" ) {
					document.getElementById("smilesLines").innerHTML = document.getElementById("smilesLines").innerHTML + "\n" + jsmeApplet.smiles();
				} else {
					document.getElementById("smilesLines").innerHTML = jsmeApplet.smiles();
				}
			}
		</script>

		<div id="jsme_container"></div>
		<p>SMILES: <b><span  id="smiles_container" ></span></b></p>
		<a onclick="transfer_smiles()" class="button alt">Transfer SMILES >></a>
		<p>
		Select a file:</p>
		<input type="file" id="input" onchange="handleFiles(this.files)">
	</section>
	<section>
		<h2>Simplified Molecular Input Line Entry Specification</h2>
		<form id="SearchForm" method="post" action="/">
	        {{ form.smiles.label }} {{ form.smiles(id="smilesLines", cols="30", rows="5") }}
		    {{ form.csrf_token }}
			<input type="submit" value="Run" class="button alt" />
		</form>
	</section>
{% endblock %}
